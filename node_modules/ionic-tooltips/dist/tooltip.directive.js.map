{"version":3,"sources":["../src/tooltip.directive.ts"],"names":[],"mappings":"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","file":"tooltip.directive.js","sourceRoot":"","sourcesContent":["import {\n  Directive, ElementRef, Input, ApplicationRef, ComponentFactoryResolver,\n  ViewContainerRef, ComponentRef, AfterViewInit\n} from '@angular/core';\nimport { Platform } from 'ionic-angular';\nimport { TooltipBox } from './tooltip-box.component';\n\n\nexport class Tooltip implements AfterViewInit {\n\n   tooltip: string;\n\n   positionV: string;\n\n   positionH: string;\n\n   event: 'press' | 'click' | 'hover' = 'click';\n\n  \n  set navTooltip(val: boolean) {\n    this._navTooltip = typeof val !== 'boolean' || val != false;\n  }\n  get navTooltip(): boolean {\n    return this._navTooltip;\n  }\n\n  \n  set arrow(val: boolean) {\n    this._arrow = typeof val !== 'boolean' || val != false;\n  }\n  get arrow(): boolean { return this._arrow; }\n\n   duration: number = 3000;\n\n   set active(val: boolean) {\n    this._active = typeof val !== 'boolean' || val != false;\n    this._active\n      ? this.canShow && this.showTooltip()\n      : this._removeTooltip();\n  }\n  get active(): boolean { return this._active; }\n\n  private _arrow: boolean = false;\n  private _navTooltip: boolean = false;\n  private tooltipElement: ComponentRef<TooltipBox>;\n  private tooltipTimeout: any;\n  private _canShow: boolean = true;\n  private _active: boolean = false;\n\n  constructor(\n      private el: ElementRef, \n      private appRef: ApplicationRef, \n      private platform: Platform, \n      private _componentFactoryResolver: ComponentFactoryResolver\n  ) {}\n\n  /**\n   * Show the tooltip immediately after initiating view if set to \n   */\n  ngAfterViewInit() {\n    if (this._active) {\n      this.trigger();\n    }\n  }\n\n  /**\n   * Set the canShow property \n   * Ensure that tooltip is shown only if the tooltip string is not falsey\n   */\n  set canShow(show: boolean) {\n    this._canShow = show;\n  }\n\n  /**\n   * @return {boolean} TRUE if the tooltip can be shown\n   */\n  get canShow(): boolean {\n    return this._canShow && this.tooltip != \"\";\n  }\n\n  /**\n   * Handles the click/press event and shows a tooltip.\n   * If a tooltip already exists, it will just reset it's timer.\n   */\n  trigger() {\n    if (!this.canShow) return;\n\n    if (this.tooltipElement) {\n      this._resetTimer();\n    } else {\n      this.showTooltip();\n    }\n  }\n\n\n  /**\n   * Creates a new tooltip component and adjusts it's properties to show properly.\n   */\n  showTooltip() {\n\n    this._createTooltipComponent();\n\n    const tooltipComponent: TooltipBox = this.tooltipElement.instance;\n\n    tooltipComponent.text = this.tooltip;\n    tooltipComponent.init.then(() => {\n\n      const tooltipPosition = this._getTooltipPosition();\n\n      tooltipComponent.posLeft = tooltipPosition.left;\n      tooltipComponent.posTop = tooltipPosition.top;\n\n      tooltipComponent.fadeState = 'visible';\n\n      if (this.arrow) {\n        let arrowPosition;\n        if (this.positionV === 'top') {\n          arrowPosition = 'bottom';\n        } else if (this.positionV === 'bottom') {\n          arrowPosition = 'top';\n        } else if (this.positionH === 'left') {\n          arrowPosition = 'right';\n        } else {\n          arrowPosition = 'left';\n        }\n        tooltipComponent.arrow = arrowPosition;\n      }\n\n      if (!this._active) {\n        this.tooltipTimeout = setTimeout(this._removeTooltip.bind(this), this.duration);\n      }\n\n    });\n\n  }\n\n  private _createTooltipComponent() {\n    let\n        viewport: ViewContainerRef = (<any>this.appRef.components[0])._component._viewport,\n        componentFactory = this._componentFactoryResolver.resolveComponentFactory(TooltipBox);\n\n    this.tooltipElement = viewport.createComponent(componentFactory);\n  }\n\n  private _getTooltipPosition() {\n    const\n        tooltipNativeElement: HTMLElement = this.tooltipElement.instance.getNativeElement(),\n        el: HTMLElement = this.el.nativeElement,\n        rect: ClientRect = el.getBoundingClientRect();\n\n    let positionLeft: number, positionTop: number, spacing: number = 10;\n\n    if (this.navTooltip) {\n      this.positionV = 'bottom';\n      this.arrow = false;\n      spacing = 20;\n    }\n\n\n    if (this.positionH === 'right') {\n      positionLeft = rect.right + spacing;\n    } else if (this.positionH === 'left') {\n      positionLeft = rect.left - spacing - tooltipNativeElement.offsetWidth;\n    } else if (this.navTooltip) {\n      positionLeft = rect.left + el.offsetWidth / 2\n    } else {\n      positionLeft = rect.left;\n    }\n\n    if (this.positionV === 'top') {\n      positionTop = rect.top - spacing - tooltipNativeElement.offsetHeight;\n    } else if(this.positionV === 'bottom') {\n      positionTop = rect.bottom + spacing;\n    } else {\n      positionTop = (rect.top + el.offsetHeight / 2) - tooltipNativeElement.offsetHeight / 2;\n    }\n\n    if (positionLeft + tooltipNativeElement.offsetWidth + spacing > this.platform.width()) {\n      positionLeft = this.platform.width() - tooltipNativeElement.offsetWidth - spacing;\n    } else if (positionLeft + tooltipNativeElement.offsetWidth - spacing < 0) {\n      positionLeft = spacing;\n    }\n\n    return {\n      left: positionLeft,\n      top: positionTop\n    };\n  }\n\n  private _removeTooltip() {\n    if (!this.tooltipElement) {\n      this.tooltipElement = undefined;\n      this.tooltipTimeout = undefined;\n      return;\n    }\n\n    this.tooltipElement.instance.fadeState = 'invisible';\n\n    this.canShow = false;\n\n    // wait for animation to finish then clear everything out\n    setTimeout(() => {\n      this.tooltipElement.destroy();\n      this.tooltipElement = undefined;\n      this.tooltipTimeout = undefined;\n      this.canShow = true;\n    }, 300);\n  }\n\n  private _resetTimer() {\n    this.active = false;\n    clearTimeout(this.tooltipTimeout);\n    this.tooltipTimeout = setTimeout(this._removeTooltip.bind(this), this.duration);\n  }\n\nstatic decorators: DecoratorInvocation[] = [\n{ type: Directive, args: [{\n  selector: '[tooltip]',\n  host: {\n    '(press)': 'event === \"press\" && trigger()',\n    '(click)': 'event === \"click\" && trigger()',\n    '(mouseenter)': 'event === \"hover\" && active = true',\n    '(mouseleave)': 'event === \"hover\" && active = false'\n  }\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: ElementRef, },\n{type: ApplicationRef, },\n{type: Platform, },\n{type: ComponentFactoryResolver, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'tooltip': [{ type: Input },],\n'positionV': [{ type: Input },],\n'positionH': [{ type: Input },],\n'event': [{ type: Input },],\n'navTooltip': [{ type: Input },],\n'arrow': [{ type: Input },],\n'duration': [{ type: Input },],\n'active': [{ type: Input },],\n};\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}